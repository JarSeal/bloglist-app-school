(this["webpackJsonpbloglist-frontend"]=this["webpackJsonpbloglist-frontend"]||[]).push([[0],{24:function(e,t,n){},25:function(e,t,n){},43:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1),c=n.n(a),i=n(17),s=n.n(i),o=n(2),l=n.n(o),u=n(6),b=n(3),j=(n(24),c.a.forwardRef((function(e,t){var n=Object(a.useState)(!1),c=Object(b.a)(n,2),i=c[0],s=c[1],o=Object(a.useState)(0),l=Object(b.a)(o,2),u=l[0],j=l[1],p=function(){j(1)};Object(a.useImperativeHandle)(t,(function(){return{toggleVisibility:p}}));var m,d;return Object(r.jsxs)("div",{className:"togglable",style:{position:"relative",maxWidth:"960px"},children:[Object(r.jsx)("div",{style:{display:!i&&(i||0===u)||e.keepButtonVisible?"":"none"},children:Object(r.jsx)("button",{onClick:p,className:"toggle-button",children:e.label})}),Object(r.jsxs)("div",{className:(m=u,d=i,u>0&&setTimeout((function(){u<2?j(u+1):(j(0),s(!i))}),2===u?500:100),"toggle-area phase-"+m+" visi-"+d),style:{transitionDuration:"600ms"},children:[Object(r.jsx)("div",{style:{position:"absolute",top:"5px",right:"5px"},children:Object(r.jsx)("button",{onClick:p,title:"cancel",className:"close-button"})}),e.children]})]})})));j.displayName="Togglable";var p,m=j,d=(n(25),function(e,t,n){return e?Object(r.jsx)("div",{className:"info-row align-right",children:Object(r.jsx)("button",{className:"delete-button",onClick:function(){return n(t)},children:"delete"})}):null}),f=function(e){var t=e.blog,n=e.handleLikeClick,c=e.handleDeleteClick,i=e.user,s=Object(a.useState)(!1),o=Object(b.a)(s,2),l=o[0],u=o[1];return Object(r.jsxs)("div",{className:"blog-item",children:[Object(r.jsxs)("h3",{className:"title",children:[t.title,Object(r.jsx)("span",{className:"author",children:t.author?"by "+t.author:t.user?"by "+t.user.name:""}),Object(r.jsxs)("span",{className:"likes-big",children:[t.likes,Object(r.jsx)("span",{children:"likes"})]})]}),Object(r.jsx)(m,{label:"info",keepButtonVisible:"true",children:Object(r.jsxs)("div",{style:{paddingBottom:"12px"},children:[Object(r.jsxs)("div",{className:"info-row info-row--url",children:[Object(r.jsx)("span",{className:"info-row__label",children:"URL: "}),Object(r.jsx)("a",{href:t.url,children:t.url})]}),Object(r.jsxs)("div",{className:"info-row info-row--likes",children:[Object(r.jsx)("span",{className:"info-row__label",children:"Likes: "}),t.likes,Object(r.jsx)("button",{className:l?"like-button loading":"like-button",onClick:function(){return n(t,l,u)},children:l?"saving..":"like"})]}),Object(r.jsxs)("div",{className:"info-row",children:[Object(r.jsx)("span",{className:"info-row__label",children:"Creator: "}),t.user&&t.user.name?t.user.name:"--"]}),d(i,t,c)]})})]})},h=n(7),g=n.n(h),x={login:function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.post("/api/login",t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},O=function(){var e=Object(u.a)(l.a.mark((function e(t,n,r,a,c,i,s,o){var u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,x.login({username:n,password:r});case 4:u=e.sent,a(u),o.setItem("blogAppUser",JSON.stringify(u)),c(""),i(""),s({msg:"Welcome ".concat(u.name,"!"),type:1,length:5e3,phase:1}),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),s({msg:"Wrong username or password!",type:2,length:5e3,phase:1});case 15:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t,n,r,a,c,i,s,o){return e.apply(this,arguments)}}(),v=function(e,t,n,a,c,i,s){return Object(r.jsxs)("div",{className:"login-form form-wrapper",children:[Object(r.jsx)("h3",{children:"Login"}),Object(r.jsxs)("form",{onSubmit:function(r){return O(r,e,t,n,a,c,i,s)},children:[Object(r.jsx)("div",{className:"form-elem form-elem__input-text",children:Object(r.jsxs)("label",{htmlFor:"login-user",children:[Object(r.jsx)("span",{className:"label-text",children:"Username:"}),Object(r.jsx)("input",{id:"login-user",className:"input-text",type:"text",value:e,name:"Username",onChange:function(e){var t=e.target;return a(t.value)}})]})}),Object(r.jsx)("div",{className:"form-elem form-elem__input-text",children:Object(r.jsxs)("label",{htmlFor:"login-pass",children:[Object(r.jsx)("span",{className:"label-text",children:"Password:"}),Object(r.jsx)("input",{id:"login-pass",className:"input-text",type:"password",value:t,name:"Password",onChange:function(e){var t=e.target;return c(t.value)}})]})}),Object(r.jsx)("div",{className:"form-elem form-elem__submit",children:Object(r.jsx)("button",{type:"submit",id:"login-button",children:"login"})})]})]})},w=function(e,t,n,a){return Object(r.jsxs)("div",{className:"logged-in-bar",style:{marginBottom:"12px",paddingBottom:"8px",borderBottom:"2px dashed #bbb"},children:[e.name," logged in \xa0",Object(r.jsx)("button",{onClick:function(e){return function(e,t,n,r){r.removeItem("blogAppUser"),t(null),n({msg:"You are now logged out!",type:1,length:5e3,phase:1})}(0,t,n,a)},children:"logout"})]})},y=function(e){var t=e.user,n=e.setUser,c=e.setLoginNote,i=e.ls,s=Object(a.useState)(""),o=Object(b.a)(s,2),l=o[0],u=o[1],j=Object(a.useState)(""),p=Object(b.a)(j,2),m=p[0],d=p[1];return Object(r.jsx)("div",{className:"login-wrapper",children:null===t?v(l,m,n,u,d,c,i):w(t,n,c,i)})},N=n(5),k=(n(43),function(e,t,n){var r=e.type,a="notification"+function(e,t,n,r,a){switch(t){case 1:return clearTimeout(p),p=setTimeout((function(){r(Object(N.a)(Object(N.a)({},n),{},{phase:2}))}),a)," notification--start";case 2:return clearTimeout(p),0!==e&&(p=setTimeout((function(){r(Object(N.a)(Object(N.a)({},n),{},{phase:3}))}),e-10))," notification--middle";case 3:return clearTimeout(p),p=setTimeout((function(){r(Object(N.a)(Object(N.a)({},n),{},{phase:4}))}),10)," notification--end-begin";case 4:return clearTimeout(p),p=setTimeout((function(){r({msg:"",type:0,length:0,phase:0})}),a)," notification--end-begin notification--end";default:return""}}(e.length,e.phase,e,t,n);switch(r){case 1:return a+" notification--done";case 2:return a+" notification--warning";case 3:return a+" notification--error";case 4:return a+" notification--warning notification--confirmation";default:return a+" notification--hidden"}}),_=function(e){var t=e.note,n=e.setNote,a=[];return t&&t.msg.length?(a.push(t.msg),4===t.type&&a.push(Object(r.jsxs)("div",{className:"notification__confirm-area",children:[Object(r.jsx)("button",{onClick:function(){return function(e,t,n){t(Object(N.a)(Object(N.a)({},e),{},{phase:3})),setTimeout(e.action,n)}(t,n,300)},title:"Confirm",className:"notification__button notification__button--confirm",children:"Confirm"},"confirm-button"),"\xa0",Object(r.jsx)("button",{onClick:function(){return n(Object(N.a)(Object(N.a)({},t),{},{phase:3}))},title:"Cancel",className:"notification__button notification__button--cancel",children:"Cancel"},"cancel-button")]},"confirm-area")),a.push(Object(r.jsx)("button",{onClick:function(){return n(Object(N.a)(Object(N.a)({},t),{},{phase:3}))},title:"Close this notification",className:"close-button"},"close-button"))):a.concat(null),Object(r.jsx)("div",{className:"notification-box-wrapper",children:Object(r.jsx)("div",{className:k(t,n,300),style:{transitionDuration:"300ms"},children:a})})},C=function(e){var t=e.handleCreateNew,n=e.blogRef,c=Object(a.useState)(""),i=Object(b.a)(c,2),s=i[0],o=i[1],l=Object(a.useState)(""),u=Object(b.a)(l,2),j=u[0],p=u[1],m=Object(a.useState)(""),d=Object(b.a)(m,2),f=d[0],h=d[1];return Object(r.jsxs)("div",{className:"create-blog-form form-wrapper",children:[Object(r.jsx)("h3",{children:"Create new blog"}),Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t(s,j,f,o,p,h)},id:"new-blog-form",children:[Object(r.jsx)("div",{className:"form-elem form-elem__input-text",children:Object(r.jsxs)("label",{htmlFor:"create-title",children:[Object(r.jsx)("span",{className:"label-text",children:"Title *"}),Object(r.jsx)("input",{id:"create-title",className:"input-text",type:"text",value:s,name:"Title",onChange:function(e){var t=e.target;return o(t.value)}})]})}),Object(r.jsx)("div",{className:"form-elem form-elem__input-text",children:Object(r.jsxs)("label",{htmlFor:"create-author",children:[Object(r.jsx)("span",{className:"label-text",children:"Author"}),Object(r.jsx)("input",{id:"create-author",className:"input-text",type:"text",value:j,name:"Author",onChange:function(e){var t=e.target;return p(t.value)}})]})}),Object(r.jsx)("div",{className:"form-elem form-elem__input-text",children:Object(r.jsxs)("label",{htmlFor:"create-url",children:[Object(r.jsx)("span",{className:"label-text",children:"URL *"}),Object(r.jsx)("input",{id:"create-url",className:"input-text",type:"text",value:f,name:"URL",onChange:function(e){var t=e.target;return h(t.value)}})]})}),Object(r.jsxs)("div",{className:"form-elem form-elem__submit",children:[Object(r.jsx)("button",{type:"submit",id:"create-new-button",children:"Create new"}),n&&Object(r.jsx)("button",{type:"button",className:"cancel-button",onClick:function(){return n.current.toggleVisibility()},children:"Cancel"})]})]})]})},S="/api/blogs",T=null,B={getAll:function(){return g.a.get(S).then((function(e){return e.data}))},setToken:function(e){T="bearer ".concat(e)},newBlog:function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:T}},e.next=3,g.a.post(S,t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),likeBlog:function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.a.put("/api/blogs/"+t.id,t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteBlog:function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={headers:{Authorization:T}},e.next=3,g.a.delete("/api/blogs/"+t,n);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},I=!1,L=function(e){return!!I&&Object.prototype.hasOwnProperty.call(window.localStorage,e)},A=function(){var e="testLSAvailability";try{return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),!0}catch(t){return!1}},U={initLocalStorage:function(){A()&&(I=!0)},getItem:function(e,t){return I&&L(e)?window.localStorage.getItem(e):t||null},setItem:function(e,t){return!!I&&(window.localStorage.setItem(e,t),!0)},removeItem:function(e){return!!I&&(L(e)&&window.localStorage.removeItem(e),!0)}},R=(n(44),n(45),function(){var e=Object(a.useRef)(),t=Object(a.useState)([]),n=Object(b.a)(t,2),c=n[0],i=n[1],s=Object(a.useState)(null),o=Object(b.a)(s,2),j=o[0],p=o[1],d=Object(a.useState)({msg:"",type:0,length:0,phase:0}),h=Object(b.a)(d,2),g=h[0],x=h[1];Object(a.useEffect)((function(){U.initLocalStorage();var e=U.getItem("blogAppUser");if(e){var t=JSON.parse(e);p(t),B.setToken(t.token)}B.getAll().then((function(e){return i(e)}))}),[]);var O=function(){var e=Object(u.a)(l.a.mark((function e(t,n,r){var a,s,o,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=2;break}return e.abrupt("return");case 2:return r(!0),e.prev=3,a=t.user.id,s=t.likes+1,o=Object.assign({},t,{user:a,likes:s}),e.next=9,B.likeBlog(o);case 9:t.likes=s,u=(u=c.filter((function(e){return e.id!==t.id?e:null}))).concat(t),i(u),r(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),x({msg:"Error in saving like action.",type:3,length:0,phase:1}),r(!1);case 20:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t,n,r){return e.apply(this,arguments)}}(),v=function(e){x({msg:"Delete blog: ".concat(e.title,"?"),type:4,length:0,phase:1,action:function(){var t=Object(u.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,B.deleteBlog(e.id);case 3:n=c.filter((function(t){return t.id!==e.id?t:null})),i(n),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),x({msg:"Error in deleting blog.",type:3,length:0,phase:1});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(){return t.apply(this,arguments)}}()})},w=function(){var t=Object(u.a)(l.a.mark((function t(n,r,a,s,o,u){var b,j,p;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,B.newBlog({title:n,author:r,url:a});case 3:b=t.sent,j=c.concat(b),i(j),s(""),o(""),u(""),x({msg:"New blog (".concat(n,") saved!"),type:1,length:5e3,phase:1}),e&&e.current.toggleVisibility(),t.next=26;break;case 13:if(t.prev=13,t.t0=t.catch(0),!t.t0.response||400!==t.t0.response.status||void 0===t.t0.response.data.errors){t.next=25;break}if(void 0===(p=t.t0.response.data.errors).title){t.next=22;break}return x({msg:"Title cannot be empty.",type:2,length:5e3,phase:1}),t.abrupt("return");case 22:if(void 0===p.url){t.next=25;break}return x({msg:"URL cannot be empty.",type:2,length:5e3,phase:1}),t.abrupt("return");case 25:x({msg:"Error, could not create new blog!",type:3,length:0,phase:1});case 26:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e,n,r,a,c,i){return t.apply(this,arguments)}}();return Object(r.jsxs)("div",{style:{fontFamily:"sans-serif",color:"#333",maxWidth:"960px",margin:"0 auto"},children:[Object(r.jsx)("h2",{children:"Blogs"}),Object(r.jsx)(_,{note:g,setNote:x}),Object(r.jsx)(y,{user:j,setUser:p,setLoginNote:x,ls:U}),null!==j&&Object(r.jsx)(m,{label:"+ New blog",ref:e,children:Object(r.jsx)(C,{handleCreateNew:w,blogRef:e})}),Object(r.jsx)("div",{className:"blog-list",children:c.sort((function(e,t){return t.likes-e.likes})).map((function(e){return Object(r.jsx)(f,{blog:e,handleLikeClick:O,handleDeleteClick:v,user:j},e.id)}))}),Object(r.jsx)("footer",{style:{opacity:.2,fontSize:"12px",textAlign:"center",marginTop:"-18px",marginBottom:"50px"},children:"by Kai Forsman"})]})});s.a.render(Object(r.jsx)(R,{}),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.1e085170.chunk.js.map